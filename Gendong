-- Carry Tool Script
local Tool = Instance.new("Tool")
Tool.Name = "CarryTool"
Tool.RequiresHandle = false
Tool.CanBeDropped = false
Tool.Parent = game.Players.LocalPlayer.Backpack

local carrying = false
local carriedPlayer = nil

-- Function untuk mencari target player yang dekat
local function getClosestPlayer(character, range)
	local closest = nil
	local shortest = range or 10
	for _, plr in pairs(game.Players:GetPlayers()) do
		if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") and plr ~= game.Players.LocalPlayer then
			local mag = (plr.Character.HumanoidRootPart.Position - character.HumanoidRootPart.Position).magnitude
			if mag < shortest then
				shortest = mag
				closest = plr
			end
		end
	end
	return closest
end

Tool.Activated:Connect(function()
	local char = Tool.Parent
	local humRoot = char:FindFirstChild("HumanoidRootPart")
	if not humRoot then return end

	if carrying then
		-- Lepaskan player
		if carriedPlayer and carriedPlayer.Character and carriedPlayer.Character:FindFirstChild("HumanoidRootPart") then
			carriedPlayer.Character.HumanoidRootPart.Anchored = false
			carriedPlayer = nil
		end
		carrying = false
	else
		-- Cari target untuk digendong
		local target = getClosestPlayer(char, 10)
		if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
			carriedPlayer = target
			local rootPart = target.Character.HumanoidRootPart

			-- Anchor sementara agar nempel
			rootPart.Anchored = true
			rootPart.CFrame = humRoot.CFrame * CFrame.new(0,2,-1)

			carrying = true
		end
	end
end)

Tool.Unequipped:Connect(function()
	if carrying and carriedPlayer and carriedPlayer.Character and carriedPlayer.Character:FindFirstChild("HumanoidRootPart") then
		carriedPlayer.Character.HumanoidRootPart.Anchored = false
	end
	carrying = false
	carriedPlayer = nil
end)
